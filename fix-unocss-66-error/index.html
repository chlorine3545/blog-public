<!doctype html><html lang="zh-CN"><head><title>园子里的日光</title>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="referrer" content="no-referrer"><meta name="description" content="本文讲述了作者在使用UnoCSS过程中因版本更新引发的配置兼容性问题及其解决过程。作者原本沿用旧版配置方案，但在更新依赖包后遭遇构建失败却无明确报错信息，通过逐步排查发现新版UnoCSS对图标预设语法要求更严格。经查阅文档发现原配置中图标集合的手动注册方式已不兼容，转而采用自动检测机制后问题得以解决。最终确认问题根源在于presetIcons模块的调用方式未遵循最新规范。该案例凸显了依赖版本管理的重要性，同时展示了通过最小化测试与官方文档对照排查技术问题的典型思路。"><meta name="keywords" content="博客,UnoCSS"><meta name="application-name" content="园子里的日光"><meta name="apple-mobile-web-app-title" content="园子里的日光"><meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)"><meta name="theme-color" content="#1a1b1e" media="(prefers-color-scheme: dark)"><meta property="og:title" content="解决UnoCSS更新后的奇怪报错 - 园子里的日光"><meta property="og:description" content="本文讲述了作者在使用UnoCSS过程中因版本更新引发的配置兼容性问题及其解决过程。作者原本沿用旧版配置方案，但在更新依赖包后遭遇构建失败却无明确报错信息，通过逐步排查发现新版UnoCSS对图标预设语法要求更严格。经查阅文档发现原配置中图标集合的手动注册方式已不兼容，转而采用自动检测机制后问题得以解决。最终确认问题根源在于presetIcons模块的调用方式未遵循最新规范。该案例凸显了依赖版本管理的重要性，同时展示了通过最小化测试与官方文档对照排查技术问题的典型思路。"><meta property="og:type" content="article"><meta property="og:url" content="https://chlor.me/fix-unocss-66-error/"><meta property="og:site_name" content="园子里的日光"><meta property="article:published_time" content="2025-02-24T00:00:00+00:00"><meta property="article:modified_time" content="2025-02-24T00:00:00+00:00"><meta property="article:author" content="Chlorine"><meta property="article:tag" content="博客"><meta property="article:tag" content="UnoCSS"><meta property="article:section" content="图灵机"><meta property="og:image" content="https://img.clnya.fun/avatar/01.webp"><title>解决UnoCSS更新后的奇怪报错 | 园子里的日光</title>
<link rel="icon" href="/favicon.svg" type="image/svg+xml"><script>(function(){const e=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");(e==="dark"||e==="auto"&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.documentElement.classList.add("dark")})()</script><link rel="stylesheet" href="/css/main.min.e464c965adcb359ccf50018707280010cd22711ea4585b4f4f3a54d6cefb9f9f.css" integrity="sha256-5GTJZa3LNZzPUAGHBygAEM0icR6kWFtPTzpU1s77n58=" crossorigin="anonymous"><link rel="stylesheet" href="/css/uno.min.3e9bb6d280f8af364980f77738039c0dde411f1fb47929a3aea41d71dac53e79.css" integrity="sha256-Ppu20oD4rzZJgPd3OAOcDd5BHx+0eSmjrqQdcdrFPnk=" crossorigin="anonymous"><link rel="stylesheet" href="/css/prose.min.6912a641fe6c17097818eb1e2a6700650aebbd7d4c177f4166b15fd55a75aa29.css" integrity="sha256-aRKmQf5sFwl4GOseKmcAZQrrvX1MF39BZrFf1Vp1qik=" crossorigin="anonymous"><link rel="stylesheet" href="/css/lightbox.min.ffc5cc4e2e6402cf607cdbb904a5d747f8443612c8cb8014ab901cc6c41f5dd2.css" integrity="sha256-/8XMTi5kAs9gfNu5BKXXR/hENhLIy4AUq5AcxsQfXdI=" crossorigin="anonymous"><link rel="stylesheet" href="/css/scroll.min.c86a4db3c7b214919b90295be86a8ac6490610845c0f6d8cd8cc7d230478a22e.css" integrity="sha256-yGpNs8eyFJGbkClb6GqKxkkGEIRcD22M2Mx9IwR4oi4=" crossorigin="anonymous"><link rel="stylesheet" href="/css/components/article/shiki.min.c0e6db88b257cd1eb6333abe1275a053124ebdc0c8e7c930a89591f44c43c577.css" integrity="sha256-wObbiLJXzR62Mzq+EnWgUxJOvcDI58kwqJWR9ExDxXc=" crossorigin="anonymous"><link rel="stylesheet" href="/css/components/article/clickcopy.min.84a456e78e8f6cbbd747aa26ded29875ddb051d01f29ff9185ebd9aee32ef397.css" integrity="sha256-hKRW546PbLvXR6om3tKYdd2wUdAfKf+RhevZruMu85c=" crossorigin="anonymous"><link rel="stylesheet" href="/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css" integrity="sha256-47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU=" crossorigin="anonymous"><script src="/js/components/lightbox.9bc8b6a23d67e97480f013aa933f45e43ff50ca0f5ad37b9b4da1db6ce09b901.js" integrity="sha256-m8i2oj1n6XSA8BOqkz9F5D/1DKD1rTe5tNodts4JuQE=" crossorigin="anonymous" defer></script><script src="/js/components/clickcopy.5bbf4d054a73a21043f7d84298fc4772b74b329b7609640ee165a537d054c93c.js" integrity="sha256-W79NBUpzohBD99hCmPxHcrdLMpt2CWQO4WWlN9BUyTw=" crossorigin="anonymous" defer></script></head><body class="flex flex-col min-h-screen bg-background text-foreground dark:bg-background-dark dark:text-foreground-dark transition-colors"><div id="loading-screen" class="fixed inset-0 z-[100] bg-background flex items-center justify-center transition-opacity duration-500"><div class="flex flex-col items-center gap-4"><div class="relative w-12 h-12"><div class="absolute inset-0 border-t-2 border-primary/20 rounded-full"></div><div class="absolute inset-0 border-t-2 border-primary rounded-full animate-spin"></div></div><div class="flex items-center gap-2"><div class="w-1.5 h-1.5 rounded-full bg-primary/80 animate-bounce-delay-1"></div><div class="w-1.5 h-1.5 rounded-full bg-primary/80 animate-bounce-delay-2"></div><div class="w-1.5 h-1.5 rounded-full bg-primary/80 animate-bounce-delay-3"></div></div><div class="text-sm text-muted-foreground/70 animate-pulse">别着急，坐和放宽</div></div></div><div class="flex flex-col flex-grow"><nav class="fixed top-0 left-0 right-0 bg-background/80 dark:bg-background-dark/80 backdrop-blur z-50"><div class="container max-w-6xl mx-auto px-4 flex items-center h-16"><a href="/" class="shrink-0"><img src="https://img.clnya.fun/avatar/01.webp" alt="avatar" class="w-8 h-8 rounded-full object-cover ring-2 ring-background dark:ring-background-dark shadow-sm"></a><div class="flex mx-auto transition-all duration-300" id="nav-menu"><div class="flex items-center bg-accent/50 dark:bg-accent-dark/50 backdrop-blur rounded-full px-4 h-9 gap-6 text-sm font-medium"><div class="relative group"><a aria-label="归档" href="https://chlor.me/" class="text-muted-foreground hover:text-primary transition-colors">归档</a><div class="absolute top-full left-1/2 -translate-x-1/2 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200"><div class="w-32 py-1 rounded-lg border border-border/50 dark:border-border-dark/50 backdrop-blur shadow-lg shadow-accent/5 flex flex-col overflow-hidden"><a aria-label="分类" href="https://chlor.me/categories" class="px-2 py-1.5 text-center text-muted-foreground/70 dark:text-muted-foreground-dark/70 hover:text-primary hover:bg-accent/40 dark:hover:bg-accent-dark/40 transition-colors">分类
</a><a aria-label="时间" href="https://chlor.me/posts" class="px-2 py-1.5 text-center text-muted-foreground/70 dark:text-muted-foreground-dark/70 hover:text-primary hover:bg-accent/40 dark:hover:bg-accent-dark/40 transition-colors">时间
</a><a aria-label="标签" href="https://chlor.me/tags" class="px-2 py-1.5 text-center text-muted-foreground/70 dark:text-muted-foreground-dark/70 hover:text-primary hover:bg-accent/40 dark:hover:bg-accent-dark/40 transition-colors">标签
</a><a aria-label="系列" href="https://chlor.me/series" class="px-2 py-1.5 text-center text-muted-foreground/70 dark:text-muted-foreground-dark/70 hover:text-primary hover:bg-accent/40 dark:hover:bg-accent-dark/40 transition-colors">系列</a></div></div></div><a aria-label="友链" href="https://chlor.me/links" class="text-muted-foreground dark:text-muted-foreground-dark hover:text-primary transition-colors">友链
</a><a aria-label="如今" href="https://chlor.me/now" class="text-muted-foreground dark:text-muted-foreground-dark hover:text-primary transition-colors">如今
</a><a aria-label="关于" href="https://chlor.me/about" class="text-muted-foreground dark:text-muted-foreground-dark hover:text-primary transition-colors">关于</a></div></div><div class="absolute left-1/2 -translate-x-1/2 opacity-0 cursor-pointer transition-all duration-300 max-w-[50%] sm:max-w-[60%]" id="nav-title"><h2 class="text-base font-medium truncate hover:text-primary transition-colors" onclick="window.scrollTo({top:0,behavior:&#x22;smooth&#x22;})" aria-label="返回顶部">解决UnoCSS更新后的奇怪报错</h2></div><div class="flex items-center gap-2"><button type="button" id="search-button" class="shrink-0 inline-flex items-center justify-center w-9 h-9 rounded-full bg-background/80 dark:bg-background-dark/80 ring-0 dark:ring-0 border-0 dark:border-0 text-muted-foreground/70 dark:text-muted-foreground-dark/70 hover:bg-accent/50 dark:hover:bg-accent-dark/50 transition-colors" aria-label="搜索" onclick="document.querySelector(&#x22;.DocSearch-Button&#x22;).click()"><div class="i-carbon-search w-4 h-4"></div></button><div class="relative group"><button id="theme-toggle" class="shrink-0 inline-flex items-center justify-center w-9 h-9 rounded-full bg-background/80 ring-0 border-0 text-muted-foreground/70 hover:bg-accent/50 transition-colors" aria-label="切换主题"><div class="i-carbon-sun w-4 h-4"></div></button><div class="absolute right-0 top-full mt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200"><div class="w-9 flex flex-col rounded-xl shadow-sm shadow-accent/5"><button class="w-9 h-9 flex items-center justify-center rounded-full bg-background ring-1 ring-border dark:ring-white/40 border-0 text-muted-foreground/70 hover:bg-accent/50 hover:text-foreground transition-colors my-0.5" onclick="setTheme(&#x22;light&#x22;)" aria-label=""><div class="i-carbon-sun w-4 h-4"></div></button>
<button class="w-9 h-9 flex items-center justify-center rounded-full bg-background ring-1 ring-border dark:ring-white/40 border-0 text-muted-foreground/70 hover:bg-accent/50 hover:text-foreground transition-colors my-0.5" onclick="setTheme(&#x22;dark&#x22;)" aria-label=""><div class="i-carbon-moon w-4 h-4"></div></button>
<button class="w-9 h-9 flex items-center justify-center rounded-full bg-background ring-1 ring-border dark:ring-white/40 border-0 text-muted-foreground/70 hover:bg-accent/50 hover:text-foreground transition-colors my-0.5" onclick="setTheme(&#x22;auto&#x22;)" aria-label=""><div class="i-carbon-screen w-4 h-4"></div></button></div></div></div></div></div></nav><link rel="preconnect" href="https://6O8RM1BUT3-dsn.algolia.net" crossorigin=""><link rel="stylesheet" href="https://cdn.jsdmirror.com/npm/@docsearch/css@3" crossorigin="anonymous"><link rel="stylesheet" href="/css/components/search/docsearch.min.e9ab6523c0591ffe9d81ad080ff72fb1b120253095c4d22c3772cc170c9eec2e.css" integrity="sha256-6atlI8BZH/6dga0ID/cvsbEgJTCVxNIsN3LMFwye7C4=" crossorigin="anonymous"><div id="docsearch"></div><script src="https://cdn.jsdmirror.com/npm/@docsearch/js@3" crossorigin="anonymous" defer></script><script>document.addEventListener("DOMContentLoaded",function(){docsearch({appId:"6O8RM1BUT3",apiKey:"ceb081eaca8bade865cec00ef9e754e8",indexName:"yoghurtlee",container:"#docsearch",placeholder:"Nyanpasu~"})})</script><script>function getTheme(){const e=localStorage.getItem("theme");return e?e:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function setTheme(e){const t=document.documentElement;if(t.classList.remove("light","dark"),e==="dark")t.classList.add("dark");else if(e==="light")t.classList.add("light");else{const e=window.matchMedia("(prefers-color-scheme: dark)").matches;e?t.classList.add("dark"):t.classList.add("light")}localStorage.setItem("theme",e),updateThemeIcon(e)}function updateThemeIcon(e){const t=document.getElementById("theme-toggle"),n=e==="dark"?"i-carbon-moon":e==="light"?"i-carbon-sun":"i-carbon-screen";t.innerHTML=`<div class="${n} w-4 h-4 text-muted-foreground/70 dark:text-muted-foreground-dark/70"></div>`}document.addEventListener("DOMContentLoaded",function(){const e=getTheme();setTheme(e),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{localStorage.getItem("theme")==="auto"&&setTheme("auto")})}),document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("nav-menu"),t=document.getElementById("nav-title");let s=window.scrollY;const o=100;function n(){const n=window.scrollY;n>o?(e.style.opacity="0",e.style.pointerEvents="none",t.style.opacity="1",t.style.pointerEvents="auto"):(e.style.opacity="1",e.style.pointerEvents="auto",t.style.opacity="0",t.style.pointerEvents="none"),s=n}window.addEventListener("scroll",n),n()})</script><main class="flex-grow"><div class="container max-w-6xl mx-auto px-4 pt-24 pb-16"><div class="flex gap-16"><div class="relative"><div class="flex gap-8 max-w-6xl mx-auto px-4 py-12 md:py-20"><div class="w-full lg:max-w-3xl"><header class="mb-12"><h1 class="text-3xl font-bold mb-6">解决UnoCSS更新后的奇怪报错</h1></header><link rel="stylesheet" href="/css/components/article/ai-summary.min.2cc7520c09092e75a992b583187a21d1f73b0ef9439f84adeb1a8c4a16636c6a.css" integrity="sha256-LMdSDAkJLnWpkrWDGHoh0fc7DvlDn4St6xqMShZjbGo=" crossorigin="anonymous"><div class="ai-summary" data-component="ai-summary"><input type="checkbox" id="ai-summary__checkbox" class="ai-summary__checkbox absolute opacity-0">
<label for="ai-summary__checkbox" class="cursor-pointer block"><div class="ai-summary__container relative my-8 p-6 rounded-xl border border-border/40 backdrop-blur transition-all duration-300 hover:border-border/60"><div class="ai-summary__header flex items-center justify-between"><div class="ai-summary__title flex items-center gap-3"><div class="i-carbon-ai-status w-5 h-5 text-primary"></div><span class="text-base font-medium">AI 摘要</span></div><div class="ai-summary__controls flex items-center gap-3"><span class="ai-summary__badge px-2.5 py-0.5 text-xs rounded-md text-primary/80 dark:text-primary-dark/80 ring-1 ring-primary/20 dark:ring-primary-dark/20">109酱</span><div class="ai-summary__toggle group bg-inherit border-none ring-1 ring-gray-600 dark:ring-gray-400" aria-label="展开/收起摘要"><div class="ai-summary__icon i-carbon-chevron-down w-5 h-5 text-muted-foreground/60 transition-transform duration-200 ease-out"></div></div></div></div><div class="ai-summary__divider my-4 border-t border-border/30"></div><div class="ai-summary__content"><div class="ai-summary__text text-sm leading-relaxed text-muted-foreground">本文讲述了作者在使用UnoCSS过程中因版本更新引发的配置兼容性问题及其解决过程。作者原本沿用旧版配置方案，但在更新依赖包后遭遇构建失败却无明确报错信息，通过逐步排查发现新版UnoCSS对图标预设语法要求更严格。经查阅文档发现原配置中图标集合的手动注册方式已不兼容，转而采用自动检测机制后问题得以解决。最终确认问题根源在于presetIcons模块的调用方式未遵循最新规范。该案例凸显了依赖版本管理的重要性，同时展示了通过最小化测试与官方文档对照排查技术问题的典型思路。</div></div></div></label></div><article class="prose max-w-none"><p>各位老友，晚上好。这里是 Chlorine。</p><p>摸鱼了一节计量，终于把这个奇奇怪怪的问题解决了。遂作文以记之。</p><p>小氯之前的 UnoCSS 配置是从还在写 Efímero 的时候继承下来的，或者说直接点就是基本从<a href="https://www.ftls.xyz/">恐咖兵糖</a>大佬那抄下来的。为数不多的改动也就是加了图标导入的 <code>IconifyJSON</code> 类型，以及一些对 ALERT 短代码有好处的预制颜色类。在写 Hermeneutics 的时候，也就图省事，除了一个 <code>IconifyJSON</code> 之外什么都没改。</p><p>同时，虽然说 npm 包的版本问题就像是飞天面条大神给这个宇宙的报应，但是由于小氯实在是太菜了（用得也实在是太简单了），同时由于小氯喜欢一直保持新版本，所以把 <code>bun update</code> 当成 <code>sudo pacman -Syu</code> 玩几乎是家常便饭，也一直没什么问题。</p><p>然而今天事情不一样了。</p><p>事情大概是：小氯闲着没事 refactor 了一下 AI Summary 的部分，拿 HTML + CSS 写了个比以前的 JS 版本还顺滑的摘要框。心情非常良好的小氯就更新了一下包版本，就在打算 <code>bun run build</code> 之后就交差时，出事了。</p><p>当时的截图小氯没有留下来，具体来说，除了一个：</p><pre class="shiki shiki-themes one-light one-dark-pro" style="background-color:#FAFAFA;--shiki-dark-bg:#282c34;color:#383A42;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>(node:33920) ExperimentalWarning: Type Stripping is an experimental feature and might change at any time</span></span>
<span class="line"><span>(Use `node --trace-warnings ...` to show where the warning was created)</span></span></code></pre><p>之外，就只有一个「退出码为 1」的提示。这段话显然不是报错的根源，而退出码 1 等于什么都没说。</p><p>按说小氯酱也不是没见过这种场面，加一个参数 debug 一下：</p><pre class="shiki shiki-themes one-light one-dark-pro" style="background-color:#FAFAFA;--shiki-dark-bg:#282c34;color:#383A42;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">bun</span><span style="color:#50A14F;--shiki-dark:#98C379"> run</span><span style="color:#50A14F;--shiki-dark:#98C379"> dev</span><span style="color:#986801;--shiki-dark:#D19A66"> --verbose</span></span></code></pre><p>很好，这下连退出码为 1 都没有了，降本增效了属于是。</p><p>然后小氯尝试了很多方法，例如手动指定 config file 等，然而不能说是硕果累累吧，至少可以说是一无所获。</p><p>再试一下换个执行方式：</p><pre class="shiki shiki-themes one-light one-dark-pro" style="background-color:#FAFAFA;--shiki-dark-bg:#282c34;color:#383A42;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 直接使用路径</span></span>
<span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">./node_modules/.bin/unocss</span><span style="color:#50A14F;--shiki-dark:#98C379"> "layouts/**/*.html"</span><span style="color:#986801;--shiki-dark:#D19A66"> -o</span><span style="color:#50A14F;--shiki-dark:#98C379"> assets/css/uno.css</span><span style="color:#986801;--shiki-dark:#D19A66"> --watch</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 换一个执行器</span></span>
<span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">npx</span><span style="color:#50A14F;--shiki-dark:#98C379"> run</span><span style="color:#50A14F;--shiki-dark:#98C379"> dev</span></span></code></pre><p>没用。</p><p>既然没有信息，那么检查一下是哪个文件的问题呢？</p><pre class="shiki shiki-themes one-light one-dark-pro" style="background-color:#FAFAFA;--shiki-dark-bg:#282c34;color:#383A42;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">#!/usr/bin/env zsh</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 配置区</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E06C75">TARGET_GLOB</span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#50A14F;--shiki-dark:#98C379">"layouts/**/*.html"</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E06C75">ERROR_LOG</span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#50A14F;--shiki-dark:#98C379">"unocss_errors.log"</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E06C75">OUTPUT_CSS</span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#50A14F;--shiki-dark:#98C379">"test.css"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">rm</span><span style="color:#986801;--shiki-dark:#D19A66"> -f</span><span style="color:#50A14F;--shiki-dark:#98C379"> "</span><span style="color:#E45649;--shiki-dark:#E06C75">$ERROR_LOG</span><span style="color:#50A14F;--shiki-dark:#98C379">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">setopt</span><span style="color:#50A14F;--shiki-dark:#98C379"> extended_glob</span></span>
<span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">setopt</span><span style="color:#50A14F;--shiki-dark:#98C379"> null_glob</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"># 计数器</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E06C75">total_files</span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#50A14F;--shiki-dark:#98C379">0</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E06C75">error_files</span><span style="color:#383A42;--shiki-dark:#56B6C2">=</span><span style="color:#50A14F;--shiki-dark:#98C379">0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#0184BC;--shiki-dark:#56B6C2">echo</span><span style="color:#50A14F;--shiki-dark:#98C379"> "Starting UnoCSS batch processing..."</span></span>
<span class="line"><span style="color:#0184BC;--shiki-dark:#56B6C2">echo</span><span style="color:#50A14F;--shiki-dark:#98C379"> "----------------------------------"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">for</span><span style="color:#E45649;--shiki-dark:#E06C75"> file</span><span style="color:#A626A4;--shiki-dark:#C678DD"> in</span><span style="color:#E45649;--shiki-dark:#ABB2BF"> ${</span><span style="color:#383A42;--shiki-dark:#ABB2BF">~</span><span style="color:#E45649;--shiki-dark:#E06C75">TARGET_GLOB</span><span style="color:#E45649;--shiki-dark:#ABB2BF">}</span><span style="color:#383A42;--shiki-dark:#ABB2BF">; </span><span style="color:#A626A4;--shiki-dark:#C678DD">do</span></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 跳过非文件</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    [[ </span><span style="color:#383A42;--shiki-dark:#56B6C2">-f</span><span style="color:#50A14F;--shiki-dark:#98C379"> "</span><span style="color:#E45649;--shiki-dark:#E06C75">$file</span><span style="color:#50A14F;--shiki-dark:#98C379">"</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> ]] || </span><span style="color:#A626A4;--shiki-dark:#C678DD">continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    ((</span><span style="color:#E45649;--shiki-dark:#E06C75">total_files</span><span style="color:#383A42;--shiki-dark:#56B6C2">++</span><span style="color:#383A42;--shiki-dark:#ABB2BF">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#0184BC;--shiki-dark:#56B6C2">    echo</span><span style="color:#986801;--shiki-dark:#D19A66"> -n</span><span style="color:#50A14F;--shiki-dark:#98C379"> "Processing </span><span style="color:#E45649;--shiki-dark:#E06C75">$file</span><span style="color:#50A14F;--shiki-dark:#98C379"> ... "</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">    # 执行UnoCSS并抑制输出</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">    if</span><span style="color:#4078F2;--shiki-dark:#61AFEF"> npx</span><span style="color:#50A14F;--shiki-dark:#98C379"> unocss</span><span style="color:#50A14F;--shiki-dark:#98C379"> "</span><span style="color:#E45649;--shiki-dark:#E06C75">$file</span><span style="color:#50A14F;--shiki-dark:#98C379">"</span><span style="color:#986801;--shiki-dark:#D19A66"> --out-file</span><span style="color:#50A14F;--shiki-dark:#98C379"> "</span><span style="color:#E45649;--shiki-dark:#E06C75">$OUTPUT_CSS</span><span style="color:#50A14F;--shiki-dark:#98C379">"</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> ></span><span style="color:#50A14F;--shiki-dark:#98C379">/dev/null</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> 2>&#x26;1; </span><span style="color:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="color:#0184BC;--shiki-dark:#56B6C2">        echo</span><span style="color:#50A14F;--shiki-dark:#98C379"> "✅"</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">    else</span></span>
<span class="line"><span style="color:#0184BC;--shiki-dark:#56B6C2">        echo</span><span style="color:#50A14F;--shiki-dark:#98C379"> "❌"</span></span>
<span class="line"><span style="color:#0184BC;--shiki-dark:#56B6C2">        echo</span><span style="color:#50A14F;--shiki-dark:#98C379"> "</span><span style="color:#E45649;--shiki-dark:#E06C75">$file</span><span style="color:#50A14F;--shiki-dark:#98C379">"</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> >> </span><span style="color:#50A14F;--shiki-dark:#98C379">"</span><span style="color:#E45649;--shiki-dark:#E06C75">$ERROR_LOG</span><span style="color:#50A14F;--shiki-dark:#98C379">"</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">        ((</span><span style="color:#E45649;--shiki-dark:#E06C75">error_files</span><span style="color:#383A42;--shiki-dark:#56B6C2">++</span><span style="color:#383A42;--shiki-dark:#ABB2BF">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic">        # 保留错误现场</span></span>
<span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">        mkdir</span><span style="color:#986801;--shiki-dark:#D19A66"> -p</span><span style="color:#50A14F;--shiki-dark:#98C379"> error_dumps</span></span>
<span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">        cp</span><span style="color:#50A14F;--shiki-dark:#98C379"> "</span><span style="color:#E45649;--shiki-dark:#E06C75">$file</span><span style="color:#50A14F;--shiki-dark:#98C379">"</span><span style="color:#50A14F;--shiki-dark:#98C379"> "error_dumps/$(</span><span style="color:#4078F2;--shiki-dark:#61AFEF">date</span><span style="color:#50A14F;--shiki-dark:#98C379"> +%s)_</span><span style="color:#E45649;--shiki-dark:#98C379">${</span><span style="color:#E45649;--shiki-dark:#E06C75">file</span><span style="color:#383A42;--shiki-dark:#ABB2BF">:</span><span style="color:#E45649;--shiki-dark:#E06C75">t</span><span style="color:#E45649;--shiki-dark:#98C379">}</span><span style="color:#50A14F;--shiki-dark:#98C379">"</span><span style="color:#A0A1A7;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic"> # 使用 Zsh 的修饰符 :t 获取文件名</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">    fi</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">done</span></span>
<span class="line"></span>
<span class="line"><span style="color:#0184BC;--shiki-dark:#56B6C2">echo</span><span style="color:#50A14F;--shiki-dark:#98C379"> "----------------------------------"</span></span>
<span class="line"><span style="color:#0184BC;--shiki-dark:#56B6C2">echo</span><span style="color:#50A14F;--shiki-dark:#98C379"> "Processed </span><span style="color:#E45649;--shiki-dark:#E06C75">$total_files</span><span style="color:#50A14F;--shiki-dark:#98C379"> files"</span></span>
<span class="line"><span style="color:#0184BC;--shiki-dark:#56B6C2">echo</span><span style="color:#50A14F;--shiki-dark:#98C379"> "Found </span><span style="color:#E45649;--shiki-dark:#E06C75">$error_files</span><span style="color:#50A14F;--shiki-dark:#98C379"> problematic files"</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">[[ </span><span style="color:#E45649;--shiki-dark:#E06C75">$error_files</span><span style="color:#383A42;--shiki-dark:#56B6C2"> -gt</span><span style="color:#986801;--shiki-dark:#D19A66"> 0</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> ]] &#x26;&#x26; </span><span style="color:#0184BC;--shiki-dark:#56B6C2">echo</span><span style="color:#50A14F;--shiki-dark:#98C379"> "Error log saved to </span><span style="color:#E45649;--shiki-dark:#E06C75">$ERROR_LOG</span><span style="color:#50A14F;--shiki-dark:#98C379">"</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">if</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> [[ </span><span style="color:#383A42;--shiki-dark:#56B6C2">-f</span><span style="color:#50A14F;--shiki-dark:#98C379"> "</span><span style="color:#E45649;--shiki-dark:#E06C75">$ERROR_LOG</span><span style="color:#50A14F;--shiki-dark:#98C379">"</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> ]]; </span><span style="color:#A626A4;--shiki-dark:#C678DD">then</span></span>
<span class="line"><span style="color:#0184BC;--shiki-dark:#56B6C2">    echo</span><span style="color:#50A14F;--shiki-dark:#98C379"> "\nError Summary:"</span></span>
<span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">    cat</span><span style="color:#50A14F;--shiki-dark:#98C379"> "</span><span style="color:#E45649;--shiki-dark:#E06C75">$ERROR_LOG</span><span style="color:#50A14F;--shiki-dark:#98C379">"</span></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">fi</span></span></code></pre><p>执行。非常地漂亮，全报错了。</p><p>既然得不到任何有效信息，那么就要秉承着「计算机科学是一门玄学」的理念了。</p><p>我们先降级一下。降回 <code>65.4.0</code> 自然是可以解决问题的，但是 <code>65.5.0</code> 就不行了。去翻 UnoCSS 更新日志，没有任何发现。</p><p>按照直觉，下一步我们就该把主意打到 <code>node_modules</code> 上了。清掉缓存，清掉已有模块，重装。小氯还顺便发现 Bun 的 lockfile 变 <code>bun.lock</code> 了，以前是 <code>bun.lockb</code> 来着。不知道为什么。</p><p>然而重装没有任何作用。清除其他包，单独安装，没用。</p><p>那我们做一个最小化的构建试一下：</p><pre class="shiki shiki-themes one-light one-dark-pro" style="background-color:#FAFAFA;--shiki-dark-bg:#282c34;color:#383A42;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#0184BC;--shiki-dark:#56B6C2">echo</span><span style="color:#50A14F;--shiki-dark:#98C379"> '&#x3C;div class="bg-red-500">&#x3C;/div>'</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> | </span><span style="color:#4078F2;--shiki-dark:#61AFEF">bun</span><span style="color:#50A14F;--shiki-dark:#98C379"> run</span><span style="color:#50A14F;--shiki-dark:#98C379"> build</span><span style="color:#986801;--shiki-dark:#D19A66"> --stdin</span></span></code></pre><p>报错。</p><p>坏了，这下不得不认真对待了（</p><p>看来应该是 UnoCSS config 的问题了。之前小氯一直没怀疑这个，因为从没出过问题嘛。<del>但是，以前是以前，现在是现在</del>。</p><p>看一眼 <code>uno.config.ts</code> ……嗯哼？<code>presetUno</code>，deprecated。</p><p>按理说 deprecated 其实一般也不是不能用，但是我们还是更新一下的好。</p><p>换成最新的 <code>presetWind3</code>，问题依然存在。</p><p>会不会是 <code>presetUno</code> 的类名不兼容呢？不太可能。按小氯的经验，不兼容的类名顶多不被识别，不可能导致报错。</p><p>那我们就单独找一下每个部分的问题好了。先开个沙盒鼓捣鼓捣：</p><pre class="shiki shiki-themes one-light one-dark-pro" style="background-color:#FAFAFA;--shiki-dark-bg:#282c34;color:#383A42;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">mkdir</span><span style="color:#50A14F;--shiki-dark:#98C379"> uno-debug</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> &#x26;&#x26; </span><span style="color:#4078F2;--shiki-dark:#61AFEF">codium</span><span style="color:#E45649;--shiki-dark:#E5C07B"> $_</span></span>
<span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">bun</span><span style="color:#50A14F;--shiki-dark:#98C379"> i</span><span style="color:#50A14F;--shiki-dark:#98C379"> unocss</span></span></code></pre><p>写个极简版的 <code>index.html</code> 和 <code>uno.config.ts</code>：</p><pre class="shiki shiki-themes one-light one-dark-pro" style="background-color:#FAFAFA;--shiki-dark-bg:#282c34;color:#383A42;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">&#x3C;</span><span style="color:#E45649;--shiki-dark:#E06C75">div</span><span style="color:#986801;--shiki-dark:#D19A66"> class</span><span style="color:#383A42;--shiki-dark:#ABB2BF">=</span><span style="color:#50A14F;--shiki-dark:#98C379">"bg-red-500"</span><span style="color:#383A42;--shiki-dark:#ABB2BF">>&#x3C;/</span><span style="color:#E45649;--shiki-dark:#E06C75">div</span><span style="color:#383A42;--shiki-dark:#ABB2BF">></span></span></code></pre><pre class="shiki shiki-themes one-light one-dark-pro" style="background-color:#FAFAFA;--shiki-dark-bg:#282c34;color:#383A42;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">import</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> { </span><span style="color:#E45649;--shiki-dark:#E06C75">defineConfig</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> } </span><span style="color:#A626A4;--shiki-dark:#C678DD">from</span><span style="color:#50A14F;--shiki-dark:#98C379"> 'unocss'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">export</span><span style="color:#E45649;--shiki-dark:#C678DD"> default</span><span style="color:#4078F2;--shiki-dark:#61AFEF"> defineConfig</span><span style="color:#383A42;--shiki-dark:#ABB2BF">({</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E06C75">  rules</span><span style="color:#0184BC;--shiki-dark:#ABB2BF">:</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    [</span><span style="color:#50A14F;--shiki-dark:#98C379">'m-1'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, { </span><span style="color:#E45649;--shiki-dark:#E06C75">margin</span><span style="color:#0184BC;--shiki-dark:#ABB2BF">:</span><span style="color:#50A14F;--shiki-dark:#98C379"> '1px'</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> }],</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">  ],</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">})</span></span></code></pre><p>构建，没问题。这至少说明 UnoCSS 本身没问题（<del>废话</del>）。</p><p>加一个预设：</p><pre class="shiki shiki-themes one-light one-dark-pro" style="background-color:#FAFAFA;--shiki-dark-bg:#282c34;color:#383A42;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">import</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> { </span><span style="color:#E45649;--shiki-dark:#E06C75">defineConfig</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, </span><span style="color:#E45649;--shiki-dark:#E06C75">presetWind3</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> } </span><span style="color:#A626A4;--shiki-dark:#C678DD">from</span><span style="color:#50A14F;--shiki-dark:#98C379"> 'unocss'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">export</span><span style="color:#E45649;--shiki-dark:#C678DD"> default</span><span style="color:#4078F2;--shiki-dark:#61AFEF"> defineConfig</span><span style="color:#383A42;--shiki-dark:#ABB2BF">({</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E06C75">  presets</span><span style="color:#0184BC;--shiki-dark:#ABB2BF">:</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">    presetWind3</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(),</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">  ],</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">})</span></span></code></pre><p>随便找一个 HTML 放进去，构建。成功。</p><p>然后小氯开始一点点地把过去的 config 往回加，加到三个图标包，出事了。去掉两个，只留一个最兼容的 carbon，还是报错。</p><p>看来就是图标部分的问题了。</p><p>这下小氯没办法自己鼓捣了，于是小氯翻开了几乎从没有翻开过的 UnoCSS 文档（</p><p>然后在图标部分找到了官方案例：</p><pre class="shiki shiki-themes one-light one-dark-pro" style="background-color:#FAFAFA;--shiki-dark-bg:#282c34;color:#383A42;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">import</span><span style="color:#E45649;--shiki-dark:#E06C75"> presetIcons</span><span style="color:#A626A4;--shiki-dark:#C678DD"> from</span><span style="color:#50A14F;--shiki-dark:#98C379"> '@unocss/preset-icons/browser'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A626A4;--shiki-dark:#C678DD">export</span><span style="color:#E45649;--shiki-dark:#C678DD"> default</span><span style="color:#4078F2;--shiki-dark:#61AFEF"> defineConfig</span><span style="color:#383A42;--shiki-dark:#ABB2BF">({</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E06C75">  presets</span><span style="color:#0184BC;--shiki-dark:#ABB2BF">:</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> [</span></span>
<span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">    presetIcons</span><span style="color:#383A42;--shiki-dark:#ABB2BF">({</span></span>
<span class="line"><span style="color:#E45649;--shiki-dark:#E06C75">      collections</span><span style="color:#0184BC;--shiki-dark:#ABB2BF">:</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> {</span></span>
<span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">        carbon</span><span style="color:#0184BC;--shiki-dark:#ABB2BF">:</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> () </span><span style="color:#A626A4;--shiki-dark:#C678DD">=></span><span style="color:#0184BC;--shiki-dark:#61AFEF"> import</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(</span><span style="color:#50A14F;--shiki-dark:#98C379">'@iconify-json/carbon/icons.json'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">).</span><span style="color:#4078F2;--shiki-dark:#61AFEF">then</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(</span><span style="color:#383A42;font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">i</span><span style="color:#A626A4;--shiki-dark:#C678DD"> =></span><span style="color:#383A42;--shiki-dark:#E5C07B"> i</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#C18401;--shiki-dark:#E06C75">default</span><span style="color:#383A42;--shiki-dark:#ABB2BF">),</span></span>
<span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">        mdi</span><span style="color:#0184BC;--shiki-dark:#ABB2BF">:</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> () </span><span style="color:#A626A4;--shiki-dark:#C678DD">=></span><span style="color:#0184BC;--shiki-dark:#61AFEF"> import</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(</span><span style="color:#50A14F;--shiki-dark:#98C379">'@iconify-json/mdi/icons.json'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">).</span><span style="color:#4078F2;--shiki-dark:#61AFEF">then</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(</span><span style="color:#383A42;font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">i</span><span style="color:#A626A4;--shiki-dark:#C678DD"> =></span><span style="color:#383A42;--shiki-dark:#E5C07B"> i</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#C18401;--shiki-dark:#E06C75">default</span><span style="color:#383A42;--shiki-dark:#ABB2BF">),</span></span>
<span class="line"><span style="color:#4078F2;--shiki-dark:#61AFEF">        logos</span><span style="color:#0184BC;--shiki-dark:#ABB2BF">:</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> () </span><span style="color:#A626A4;--shiki-dark:#C678DD">=></span><span style="color:#0184BC;--shiki-dark:#61AFEF"> import</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(</span><span style="color:#50A14F;--shiki-dark:#98C379">'@iconify-json/logos/icons.json'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">).</span><span style="color:#4078F2;--shiki-dark:#61AFEF">then</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(</span><span style="color:#383A42;font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">i</span><span style="color:#A626A4;--shiki-dark:#C678DD"> =></span><span style="color:#383A42;--shiki-dark:#E5C07B"> i</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#C18401;--shiki-dark:#E06C75">default</span><span style="color:#383A42;--shiki-dark:#ABB2BF">),</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">      }</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">    })</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">  ]</span></span>
<span class="line"><span style="color:#383A42;--shiki-dark:#ABB2BF">})</span></span></code></pre><p>好吧，我改。</p><p>结果出现了错误：</p><pre class="shiki shiki-themes one-light one-dark-pro" style="background-color:#FAFAFA;--shiki-dark-bg:#282c34;color:#383A42;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span>Failed to load custom icon "screen" in "carbon": TypeError [ERR_IMPORT_ATTRIBUTE_MISSING]: Module "file:///Users/chlorine/Dev/Frontend/hermeneutics/node_modules/@iconify-json/carbon/icons.json" needs an import attribute of "type: json"</span></span></code></pre><p>好吧好吧，我加上还不行吗……</p><pre class="shiki shiki-themes one-light one-dark-pro" style="background-color:#FAFAFA;--shiki-dark-bg:#282c34;color:#383A42;--shiki-dark:#abb2bf" tabindex="0"><code><span class="line"><span style="color:#383A42;--shiki-dark:#E06C75">carbon</span><span style="color:#383A42;--shiki-dark:#ABB2BF">: () </span><span style="color:#A626A4;--shiki-dark:#C678DD">=></span><span style="color:#0184BC;--shiki-dark:#61AFEF"> import</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(</span><span style="color:#50A14F;--shiki-dark:#98C379">'@iconify-json/carbon/icons.json'</span><span style="color:#383A42;--shiki-dark:#ABB2BF">, { </span><span style="color:#E45649;--shiki-dark:#E06C75">assert</span><span style="color:#0184BC;--shiki-dark:#ABB2BF">:</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> { </span><span style="color:#E45649;--shiki-dark:#E06C75">type</span><span style="color:#0184BC;--shiki-dark:#ABB2BF">:</span><span style="color:#50A14F;--shiki-dark:#98C379"> 'json'</span><span style="color:#383A42;--shiki-dark:#ABB2BF"> } }).</span><span style="color:#4078F2;--shiki-dark:#61AFEF">then</span><span style="color:#383A42;--shiki-dark:#ABB2BF">(</span><span style="color:#383A42;font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic">i</span><span style="color:#A626A4;--shiki-dark:#C678DD"> =></span><span style="color:#383A42;--shiki-dark:#E5C07B"> i</span><span style="color:#383A42;--shiki-dark:#ABB2BF">.</span><span style="color:#E45649;--shiki-dark:#E06C75">default</span><span style="color:#383A42;--shiki-dark:#ABB2BF">),</span></span></code></pre><p>然而并没有用。</p><p>邪了门了（小氯の疑惑）。</p><p>再回去看文档……</p><blockquote class="my-6 border-l-4 border-border/60 pl-4"><p>In <code>Node.js</code> the preset will search for the installed iconify dataset automatically, so you don’t need to register the <code>iconify</code> collections.</p></blockquote><p>Bun 和 Node 应该也差不多，那把 collections 都去了试试……</p><p>正常了。</p><p>……你人还怪好的嘞。</p><p>下面把 mdi 和 simple icons 加回去吧……等会，我 simple icons 呢？我那么大一包 simple icons 呢？</p><p>再回去看文档。Icons 其实就是小氯常用的 <a href="https://icones.js.org/">Icônes</a> 里面的那些，那咱们再去看看吧。</p><p>……哦，原来人家叫 <code>i-simple-icons-xxxx</code>，不叫 <code>i-simple-xxxx</code>。这个别名是之前的写法规定的。</p><p>问题解决。</p><hr><p>总结一下，就是过去不规范的 <code>presetIcons</code> 语法和 UnoCSS 的最新标准不兼容，导致 UnoCSS 报错。至于为什么没有报错信息……小氯也不知道哦。</p></article><div class="mt-12 md:mt-16 p-6 rounded-xl border border-border/40 dark:border-border-dark/40 backdrop-blur"><div class="flex flex-col sm:flex-row gap-6"><div class="hidden sm:block flex-shrink-0"><div class="w-14 h-14 rounded-xl border border-border/40 dark:border-border-dark/40 bg-accent/30 dark:bg-accent-dark/30 flex items-center justify-center"><div class="i-carbon-license w-7 h-7 text-primary/80"></div></div></div><div class="flex-1 space-y-4"><div class="space-y-1"><h3 class="text-base font-medium">版权声明</h3><div class="flex flex-wrap items-center gap-x-2 gap-y-1 text-sm text-muted-foreground/70"><span>本文采用</span>
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1 text-primary/80 hover:text-primary transition-colors"><div class="i-carbon-link w-3.5 h-3.5"></div><span>CC BY-NC-SA 4.0</span>
</a><span>许可协议。</span></div></div><div class="text-sm space-y-2 text-muted-foreground/70"><div class="flex items-start gap-2"><div class="i-carbon-checkmark w-4 h-4 mt-0.5 text-primary/70"></div><span>转载请注明出处：<span class="select-all">https://chlor.me/fix-unocss-66-error/</span></span></div><div class="flex items-start gap-2"><div class="i-carbon-checkmark w-4 h-4 mt-0.5 text-primary/70"></div><span>本文作者：Chlorine</span></div><div class="flex items-start gap-2"><div class="i-carbon-checkmark w-4 h-4 mt-0.5 text-primary/70"></div><span>发布时间：<time class="tabular-nums">2025-02-24 00:00</time></span></div></div></div></div></div><link rel="stylesheet" href="/css/components/comments/twikoo.min.0c1c68a789714e0d50c874179f667a51d380faebfbfe7a1649e72b6e87f4138f.css" integrity="sha256-DBxop4lxTg1QyHQXn2Z6UdOA+uv7/noWSecrbof0E48=" crossorigin="anonymous"><div class="mt-12 md:mt-16 pt-6 md:pt-8 border-t border-border/40 dark:border-border-dark/40"><div class="flex items-center gap-2 mb-8"><div class="i-carbon-chat w-5 h-5 text-primary/80"></div><h3 class="text-lg font-medium">评论</h3></div><div id="twikoo" class="plain-link"></div></div><script src="https://cdn.jsdmirror.com/gh/chlorine3545/customcdn@2b63d63/js/twikoo/1_6_41.min.js" crossorigin="anonymous" defer></script><script>window.addEventListener("load",()=>{twikoo.init({envId:"https://tk.viento.cc",el:"#twikoo",lang:"zh-CN"})})</script><script src="/js/components/twikoo-owo.js" defer></script></div><aside class="hidden lg:block w-64 flex-shrink-0"><div class="sticky top-24 flex flex-col gap-6"><link rel="stylesheet" href="/css/components/article/toc.css"><div class="flex flex-col gap-4"><h3 class="text-sm font-medium text-foreground/80">目录</h3><nav class="text-sm text-foreground/70"><nav id="TableOfContents"></nav></nav></div><div class="flex flex-col gap-4"><h3 class="text-sm font-medium text-foreground/80">阅读进度</h3><div class="relative h-1 bg-border/50 rounded-full overflow-hidden"><div id="reading-progress" class="absolute inset-y-0 left-0 bg-primary/80 transition-all duration-150" style="width:0%"></div></div><div class="text-sm text-muted-foreground text-center"><span id="percent">0</span>% 已读</div></div><script src="/js/components/reading-progress.5f39156caf6576d6ce40fdecfcab492aeda6ea0932e102e04845c9361be5caa8.js" integrity="sha256-XzkVbK9ldtbOQP3s/KtJKu2m6gky4QLgSEXJNhvlyqg=" crossorigin="anonymous" defer></script></div></aside></div><div id="reading-progress-ball" class="lg:hidden fixed right-4 bottom-20 w-12 h-12 rounded-full backdrop-blur z-50 shadow-lg border border-border/20 dark:border-border-dark/20 flex items-center justify-center text-sm font-medium tabular-nums transition-all duration-300 transform translate-y-24 opacity-0">0%</div><script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("reading-progress-ball");if(!e)return;const n=document.querySelector("article");if(!n)return;function t(){const s=n.getBoundingClientRect(),r=window.innerHeight,c=-s.top,o=s.height,l=Math.min(r,o),i=o-l;let t=c/i*100;t=Math.min(100,Math.max(0,t));const d=Math.round(t);e.textContent=`${d}%`;const a=t>0&&t<100&&i>0;e.classList.toggle("translate-y-24",!a),e.classList.toggle("opacity-0",!a)}function s(e,t){let s,n=0;return function(...o){const i=Date.now(),a=this;i-n>=t?(e.apply(a,o),n=i):(clearTimeout(s),s=setTimeout(()=>{e.apply(a,o),n=Date.now()},t))}}window.addEventListener("scroll",s(t,100),{passive:!0}),window.addEventListener("resize",s(t,100),{passive:!0}),t()})</script></div></div></div></main></div><footer class="plain-link-container mt-auto py-4 backdrop-blur border-t border-border/50"><div class="container mx-auto px-4"><div class="flex flex-col gap-6"><div class="hidden mt-3 md:flex items-center gap-4 text-sm text-muted-foreground/70"><div class="flex items-center gap-2"><div class="i-carbon-time w-4 h-4"></div><span class="tabular-nums font-mono tracking-wider"><span class="text-primary/70">已运行</span>
<span id="runningtime" class="ml-1" data-start-date="12/15/2023 12:00:00"></span></span></div><script src="/js/components/runtime.9e9d6de2edbc0c1fd1e49fe58f78438aec2e85362f4d69d1494d517bdd32611b.js" integrity="sha256-np1t4u28DB/R5J/lj3hDiuwuhTYvTWnRSU1Re90yYRs=" crossorigin="anonymous" defer></script><span class="w-1 h-1 rounded-full bg-muted-foreground/30"></span><div class="flex items-center gap-2"><div class="i-carbon-text-font w-4 h-4"></div><span>共 <span class="tabular-nums font-mono">234785</span> 字
<span class="mx-1">·</span>
写完一本 简·奥斯汀 的《傲慢与偏见》了!</span></div></div><div class="hidden md:visible h-px bg-border/10"></div><div class="flex flex-col md:flex-row items-center justify-between gap-3 text-sm text-muted-foreground/60"><div class="flex flex-col md:flex-row items-center gap-2 md:gap-4"><span>© 2025 Chlorine</span><div class="flex items-center gap-4"><span>Powered by <a href="https://gohugo.io" target="_blank" rel="noopener noreferrer" class="hover:text-primary transition-colors">Hugo</a></span>
<span>Theme <a href="https://github.com/chlorine3545/hugo-theme-hermeneutics" target="_blank" rel="noopener noreferrer" class="hover:text-primary transition-colors">Hermeneutics</a></span></div></div><div class="flex flex-col md:flex-row items-center gap-2 md:gap-4"><a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 hover:text-primary transition-colors"><span>京ICP备2024074926号-5</span>
</a><span class="hidden md:inline text-border/40">|</span>
<a href="http://www.beian.gov.cn/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 hover:text-primary transition-colors"><span>京公网安备11010802044863号</span>
</a><span class="hidden md:inline text-border/40">|</span>
<a href="https://icp.gov.moe/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center gap-1.5 hover:text-primary transition-colors"><span>萌ICP备20240711号</span></a></div></div></div></div></footer><footer><script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("loading-screen");let t;function n(){e&&(e.style.opacity="0",setTimeout(()=>{e.style.display="none"},400)),t&&(clearTimeout(t),t=null)}function s(){e&&(e.style.display="flex",e.offsetHeight,e.style.opacity="1",t=setTimeout(n,3e3))}window.addEventListener("load",n),window.addEventListener("pageshow",function(e){e.persisted&&n()}),document.addEventListener("click",function(e){const t=e.target.closest("a");t&&t.href&&!t.href.startsWith("#")&&!t.href.includes("#")&&t.href!==window.location.href&&!t.hasAttribute("download")&&t.target!=="_blank"&&t.hostname===window.location.hostname&&(e.preventDefault(),s(),setTimeout(()=>{window.location.href=t.href},500))}),n()})</script></footer></body></html>